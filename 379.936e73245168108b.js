"use strict";(self.webpackChunkSouthDhakaCyclists=self.webpackChunkSouthDhakaCyclists||[]).push([[379],{7379:(U,u,p)=>{p.r(u),p.d(u,{TempFileModule:()=>C});var c=p(6895),m=p(4976),g=p(529),h=p(2347),t=p(8256);let _=(()=>{const r=class{constructor(e){this.http=e,this.api=h.N.apiUrl+"/tempfile"}uploadFile(e){const i=new FormData;return i.append("file",e),this.http.post(`${this.api}`,i,{observe:"events",reportProgress:!0})}getAllFiles(){return this.http.get(this.api)}deleteFile(e){return this.http.delete(`${this.api}/${e}`)}markImportant(e){return this.http.post(`${this.api}/mark-important/${e}`,{})}markUnimportant(e){return this.http.post(`${this.api}/mark-unimportant/${e}`,{})}verifyPassword(e){return this.http.post(`${this.api}/check-password`,{password:e})}};let a=r;return r.\u0275fac=function(i){return new(i||r)(t.LFG(g.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),a})();var d=p(433);function b(a,r){if(1&a){const s=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"number"),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td")(9,"a",34),t._uU(10,"View"),t.qZA()(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"date"),t.qZA(),t.TgZ(14,"td")(15,"button",35),t.NdJ("click",function(){const o=t.CHM(s).$implicit,n=t.oxw();return t.KtG(n.copyUrl(o.url))}),t._uU(16,"Copy"),t.qZA(),t.TgZ(17,"button",36),t.NdJ("click",function(){const o=t.CHM(s).$implicit,n=t.oxw();return t.KtG(n.makeImportant(o))}),t._uU(18,"Important"),t.qZA(),t.TgZ(19,"button",37),t.NdJ("click",function(){const o=t.CHM(s).$implicit,n=t.oxw();return t.KtG(n.deleteFile(o))}),t._uU(20,"Delete"),t.qZA()()()}if(2&a){const s=r.$implicit,e=t.oxw();t.xp6(2),t.Oqu(s.name),t.xp6(2),t.hij("",t.lcZ(5,5,s.size)," B"),t.xp6(3),t.Oqu(s.type),t.xp6(2),t.Q6J("href",e.apiUrl+s.url,t.LSH),t.xp6(3),t.Oqu(t.lcZ(13,7,s.createdAt))}}function Z(a,r){if(1&a){const s=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"input",38),t.NdJ("ngModelChange",function(i){const n=t.CHM(s).$implicit;return t.KtG(n.selected=i)}),t.qZA()(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td")(11,"a",34),t._uU(12,"View"),t.qZA()(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"date"),t.qZA(),t.TgZ(16,"td")(17,"button",35),t.NdJ("click",function(){const o=t.CHM(s).$implicit,n=t.oxw();return t.KtG(n.copyUrl(o.url))}),t._uU(18,"Copy"),t.qZA(),t.TgZ(19,"button",39),t.NdJ("click",function(){const o=t.CHM(s).$implicit,n=t.oxw();return t.KtG(n.makeUnimportant(o))}),t._uU(20,"Unimportant"),t.qZA(),t.TgZ(21,"button",37),t.NdJ("click",function(){const o=t.CHM(s).$implicit,n=t.oxw();return t.KtG(n.deleteFile(o))}),t._uU(22,"Delete"),t.qZA()()()}if(2&a){const s=r.$implicit,e=t.oxw();t.xp6(2),t.Q6J("ngModel",s.selected),t.xp6(2),t.Oqu(s.name),t.xp6(2),t.hij("",t.lcZ(7,6,s.size)," B"),t.xp6(3),t.Oqu(s.type),t.xp6(2),t.Q6J("href",e.apiUrl+s.url,t.LSH),t.xp6(3),t.Oqu(t.lcZ(15,8,s.createdAt))}}const f=[{path:"",component:(()=>{const r=class{constructor(e){this.tempService=e,this.apiUrl=h.N.apiUrl,this.files=[],this.searchText="",this.regularPage=1,this.importantPage=1,this.pageSize=5,this.password="",this.actionTargetFile=null,this.actionType=null,this.loadFiles()}loadFiles(){this.tempService.getAllFiles().subscribe(e=>{this.files=e})}onDrop(e){e.preventDefault();const i=e.dataTransfer?.files[0];i&&this.upload(i,e.target)}onDragOver(e){e.preventDefault()}onFileSelected(e){const i=e.target.files[0];i&&this.upload(i,e.target)}upload(e,i){this.tempService.uploadFile(e).subscribe(o=>{o.type===g.dt.Response&&(console.log("Upload complete"),i.value="",this.loadFiles())})}deleteFile(e){this.openPasswordModal(e,"delete")}makeImportant(e){this.openPasswordModal(e,"important")}makeUnimportant(e){this.openPasswordModal(e,"unimportant")}openPasswordModal(e,i){this.password="",this.actionTargetFile=e,this.actionType=i,new window.bootstrap.Modal(document.getElementById("passwordModal")).show()}onPasswordSubmit(){!this.actionTargetFile||!this.actionType||this.tempService.verifyPassword(this.password).subscribe(e=>{if(e.verified){switch(this.actionType){case"delete":this.tempService.deleteFile(this.actionTargetFile.name).subscribe(()=>this.loadFiles());break;case"important":this.tempService.markImportant(this.actionTargetFile.name).subscribe(()=>this.loadFiles());break;case"unimportant":this.tempService.markUnimportant(this.actionTargetFile.name).subscribe(()=>this.loadFiles())}window.bootstrap.Modal.getInstance(document.getElementById("passwordModal"))?.hide()}else alert("Invalid password")})}copyUrl(e){navigator.clipboard.writeText(this.apiUrl+e)}get filteredFiles(){return this.files.filter(e=>e.name.toLowerCase().includes(this.searchText.toLowerCase()))}get regularFiles(){return this.filteredFiles.filter(e=>!e.important)}get importantFiles(){return this.filteredFiles.filter(e=>e.important)}paginatedRegularFiles(){const e=(this.regularPage-1)*this.pageSize;return this.regularFiles.slice(e,e+this.pageSize)}paginatedImportantFiles(){const e=(this.importantPage-1)*this.pageSize;return this.importantFiles.slice(e,e+this.pageSize)}nextPage(e){"regular"===e&&this.hasMoreRegular()&&this.regularPage++,"important"===e&&this.hasMoreImportant()&&this.importantPage++}prevPage(e){"regular"===e&&this.regularPage>1&&this.regularPage--,"important"===e&&this.importantPage>1&&this.importantPage--}hasMoreRegular(){return this.regularPage*this.pageSize<this.regularFiles.length}hasMoreImportant(){return this.importantPage*this.pageSize<this.importantFiles.length}};let a=r;return r.\u0275fac=function(i){return new(i||r)(t.Y36(_))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-root"]],decls:92,vars:10,consts:[[1,"banner","p-5","mb-4","rounded-3","text-center"],[1,"display-5"],[1,"border","border-primary","border-2","p-4","text-center","mb-4","rounded",3,"drop","dragover"],[1,"mb-2"],["type","file",1,"form-control",3,"change"],["role","alert",1,"alert","alert-warning","text-center"],["src","assets/photo/tempMessage.png","alt","",1,"img-fluid","w-25","d-block","mx-auto","my-2"],[1,"input-group","mb-4"],[1,"input-group-text"],["type","text","placeholder","Type to filter...",1,"form-control",3,"ngModel","ngModelChange"],[1,"row","row-cols-1","row-cols-md-2","g-4"],[1,"col"],[1,"card","shadow-sm"],[1,"card-header"],[1,"card-title","m-0"],[1,"card-body","p-0"],[1,"table","table-striped","table-hover","mb-0"],[1,""],[4,"ngFor","ngForOf"],[1,"card-footer","text-center"],[1,"btn","btn-outline-primary","btn-sm","me-2",3,"disabled","click"],[1,"btn","btn-outline-primary","btn-sm","ms-2",3,"disabled","click"],[1,"card-header","bg-warning-subtle"],["id","passwordModal","tabindex","-1","aria-labelledby","passwordModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content","shadow"],[1,"modal-header","bg-secondary","text-white"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close","btn-close-white"],[1,"modal-body"],["type","password","placeholder","Enter password",1,"form-control",3,"ngModel","ngModelChange","keyup.enter"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-outline-secondary"],[1,"btn","btn-primary",3,"click"],["target","_blank",3,"href"],[1,"btn","btn-sm","btn-outline-secondary","me-2",3,"click"],[1,"btn","btn-sm","btn-outline-success","me-2",3,"click"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"btn","btn-sm","btn-outline-dark","me-2",3,"click"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Temp File Manager"),t.qZA()(),t.TgZ(3,"div",2),t.NdJ("drop",function(l){return o.onDrop(l)})("dragover",function(l){return o.onDragOver(l)}),t.TgZ(4,"p",3),t._uU(5,"Drag & drop your file here"),t.qZA(),t.TgZ(6,"input",4),t.NdJ("change",function(l){return o.onFileSelected(l)}),t.qZA()(),t.TgZ(7,"div",5)(8,"strong"),t._uU(9,"Warning!"),t.qZA(),t._uU(10," Everything is temporary, nothing is permanent. "),t._UZ(11,"br")(12,"img",6),t.qZA(),t.TgZ(13,"div",7)(14,"span",8),t._uU(15,"Search"),t.qZA(),t.TgZ(16,"input",9),t.NdJ("ngModelChange",function(l){return o.searchText=l}),t.qZA()(),t.TgZ(17,"div",10)(18,"div",11)(19,"div",12)(20,"div",13)(21,"h2",14),t._uU(22,"Regular Files"),t.qZA()(),t.TgZ(23,"div",15)(24,"table",16)(25,"thead",17)(26,"tr")(27,"th"),t._uU(28,"Name"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Size"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"Type"),t.qZA(),t.TgZ(33,"th"),t._uU(34,"URL"),t.qZA(),t.TgZ(35,"th"),t._uU(36,"CreatedAt"),t.qZA(),t.TgZ(37,"th"),t._uU(38,"Actions"),t.qZA()()(),t.TgZ(39,"tbody"),t.YNc(40,b,21,9,"tr",18),t.qZA()()(),t.TgZ(41,"div",19)(42,"button",20),t.NdJ("click",function(){return o.prevPage("regular")}),t._uU(43,"Prev"),t.qZA(),t._uU(44),t.TgZ(45,"button",21),t.NdJ("click",function(){return o.nextPage("regular")}),t._uU(46,"Next"),t.qZA()()()(),t.TgZ(47,"div",11)(48,"div",12)(49,"div",22)(50,"h2",14),t._uU(51,"Important Files"),t.qZA()(),t.TgZ(52,"div",15)(53,"table",16)(54,"thead",17)(55,"tr")(56,"th"),t._uU(57,"Select"),t.qZA(),t.TgZ(58,"th"),t._uU(59,"Name"),t.qZA(),t.TgZ(60,"th"),t._uU(61,"Size"),t.qZA(),t.TgZ(62,"th"),t._uU(63,"Type"),t.qZA(),t.TgZ(64,"th"),t._uU(65,"URL"),t.qZA(),t.TgZ(66,"th"),t._uU(67,"CreatedAt"),t.qZA(),t.TgZ(68,"th"),t._uU(69,"Actions"),t.qZA()()(),t.TgZ(70,"tbody"),t.YNc(71,Z,23,10,"tr",18),t.qZA()()(),t.TgZ(72,"div",19)(73,"button",20),t.NdJ("click",function(){return o.prevPage("important")}),t._uU(74,"Prev"),t.qZA(),t._uU(75),t.TgZ(76,"button",21),t.NdJ("click",function(){return o.nextPage("important")}),t._uU(77,"Next"),t.qZA()()()()(),t.TgZ(78,"div",23)(79,"div",24)(80,"div",25)(81,"div",26)(82,"h5",27),t._uU(83,"Confirm Password"),t.qZA(),t._UZ(84,"button",28),t.qZA(),t.TgZ(85,"div",29)(86,"input",30),t.NdJ("ngModelChange",function(l){return o.password=l})("keyup.enter",function(){return o.onPasswordSubmit()}),t.qZA()(),t.TgZ(87,"div",31)(88,"button",32),t._uU(89,"Cancel"),t.qZA(),t.TgZ(90,"button",33),t.NdJ("click",function(){return o.onPasswordSubmit()}),t._uU(91,"Confirm"),t.qZA()()()()()),2&i&&(t.xp6(16),t.Q6J("ngModel",o.searchText),t.xp6(24),t.Q6J("ngForOf",o.paginatedRegularFiles()),t.xp6(2),t.Q6J("disabled",1===o.regularPage),t.xp6(2),t.hij(" Page ",o.regularPage," "),t.xp6(1),t.Q6J("disabled",!o.hasMoreRegular()),t.xp6(26),t.Q6J("ngForOf",o.paginatedImportantFiles()),t.xp6(2),t.Q6J("disabled",1===o.importantPage),t.xp6(2),t.hij(" Page ",o.importantPage," "),t.xp6(1),t.Q6J("disabled",!o.hasMoreImportant()),t.xp6(10),t.Q6J("ngModel",o.password))},dependencies:[c.sg,d.Fj,d.Wl,d.JJ,d.On,c.JJ,c.uU]}),a})()}];let T=(()=>{const r=class{};let a=r;return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[m.Bz.forChild(f),m.Bz]}),a})(),C=(()=>{const r=class{};let a=r;return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[c.ez,T,d.u5]}),a})()}}]);